/**
 * Webcam library from https://github.com/elgervb/JSWebcam
 */
var Webcam=function(a){var b,c=!1,d=document.querySelector(a),e=function(){return!!navigator.getUserMedia},f=function(a){for(var b="",c=new Uint8Array(a),d=c.byteLength,e=0;d>e;e++)b+=String.fromCharCode(c[e]);return window.btoa(b)},g=function(){var a=document.getElementById("webcamCanvas");return a||(a=document.createElement("canvas"),a.id="webcamCanvas",a.style.display="none",document.body.appendChild(a)),a},h=function(){var a=document.getElementById("webcamFallback");return a||(a=document.createElement("input"),a.id="webcamFallback",a.type="file",a.accept="image/*;capture=camera",a.capture="capture",a.style.display="none",document.body.appendChild(a)),a},i=function(a,b){d.style.display="none";var c=h();g(),c.addEventListener("change",function(){var d=new FileReader,e=c.files[0];d.onloadend=function(c){var d="data:"+e.type+";base64,"+f(c.target.result),h=g(),i=h.getContext("2d"),j=new Image;j.onload=function(){h.width=j.width,h.height=j.height,b?b(i,h):i.drawImage(j,0,0),a(d)},j.src=d},d.readAsArrayBuffer(e)},!1),c.click()},j=function(){if(navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,!d)throw"Could not find element for video with selector "+a},k=function(){return!!b||c},l=function(a,c,e){d.play(),navigator.getUserMedia(a||{},function(a){d.src=window.URL.createObjectURL(a),d.onloadedmetadata=function(){b=a},c(a)},function(){i(),e&&e()})},m=function(){b&&(b.stop(),d.pause(),b=null,d.src="")},n=function(a,b){if(e()){var f=g();f.width=d.videoWidth,f.height=d.videoHeight;var h=f.getContext("2d");b?b(h,f):h.drawImage(d,0,0),a(f.toDataURL("image/png"))}else c&&i(a,b)},c=function(a){c=a},o=function(a){var b;if(b=a.split(",")[0].indexOf("base64")>=0?atob(a.split(",")[1]):unescape(a.split(",")[1]),!b)throw"Unable to fetch data from dataUri";for(var c=a.split(",")[0].split(":")[1].split(";")[0],d=[],e=0;e<b.length;e++)d.push(b.charCodeAt(e));return new Blob([new Uint8Array(d)],{type:c})};return j(),{element:function(){return d},fallback:i,isStarted:k,isSupported:e,start:l,stop:m,takePicture:n,uriToBlob:o,useFallback:c}};